{{! templates/partials/listing.hbs }}
{{!
  Expected context (per categoria):

  {
    "name": "Rosso" | "Bianco" | "Dessert",     (opzionale se già usi category-cover)
    "winesByRegion": [
      {
        "region": "Toscana",
        "winesByZone": [
          {
            "zone": "Bolgheri",
            "wines": [
              {
                "name": "Chianti Classico Riserva",
                "producer": "Antinori",
                "zone": "Bolgheri",
                "region": "Toscana",                    (opzionale)
                "abv": "Gradazione: 13,5%",          (opzionale)
                "price_glass_eur": 8,                  (opzionale)
                "price_bottle_eur": 45,                (opzionale)
                "price_eur": 45                        (fallback bottiglia)
              },
              ...
            ]
          },
          ...
        ]
      },
      ...
    ],
    "wines": [...]  (array piatto per retrocompatibilità)
  }
}}

<section class="page page--listing">
  <div class="listing-inner">

    {{! Se vuoi, puoi mostrare di nuovo il nome categoria qui (di solito no, perché c’è la category-cover) }}
    {{!--
    {{#if name}}
      <h2 class="listing-category-title">{{name}}</h2>
    {{/if}}
    --}}

    {{#each winesByRegion}}
      {{! Titolo regione }}
      {{#if region}}
        <h2 class="listing-region-title">{{region}}</h2>
      {{/if}}

      {{! Per ogni zone nella regione }}
      {{#each winesByZone}}
        {{! Titolo zone }}
        {{#if zone}}
          <h3 class="listing-zone-title">{{zone}}</h3>
        {{/if}}

        {{! Elenco vini di questa zone }}
        {{#each wines}}
          <div class="wine-row">
            <div class="wine-row-inner">
              <div class="wine-info">
                <div class="wine-name">
                  <strong>{{name}} - {{appellation}}</strong>
                </div>

                {{#if grapes}}
                  <div class="wine-grapes-line">
                    <span class="wine-grapes">{{grapes}}</span>
                  </div>
                {{/if}}

                {{#if aging}}
                  <div class="wine-aging-abv-line">
                    <span class="wine-aging">{{aging}}</span>
                    {{#if abv}}
                      <span class="wine-abv"> — {{abv}}</span>
                    {{/if}}
                  </div>
                {{/if}}

                {{#if production_location}}
                  <div class="wine-production-location-line">
                    <span class="wine-production-location">
                      {{production_location}}
                    </span>
                  </div>
                {{/if}}
              </div>

              <div class="wine-producer-column">
                {{#if producer}}
                  <span class="wine-producer">{{producer}}</span>
                {{/if}}
              </div>

              <div class="wine-prices">
                {{#if price_glass_eur}}
                  <div class="wine-price-glass">
                    {{price_glass_eur}}€
                  </div>
                {{/if}}

                {{#if price_bottle_eur}}
                  <div class="wine-price-bottle">
                    {{price_bottle_eur}}€
                  </div>
                {{else}}
                  {{#if price_eur}}
                    <div class="wine-price-bottle">
                      {{price_eur}}€
                    </div>
                  {{/if}}
                {{/if}}
              </div>
            </div>
          </div>
        {{/each}}
      {{/each}}
    {{/each}}

  </div>
</section>